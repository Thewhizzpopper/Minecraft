Forked from fogleman, will update with a changelog and new code soon
